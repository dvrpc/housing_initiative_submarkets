state = dvrpc_states,
survey = "acs5",
output = "wide"
) %>%
mutate(year = 2015) %>%
filter(str_detect(GEOID, dvrpc_fips)) %>%
select(GEOID, year, ends_with("E"), -NAME)%>%
rename("GEOID_10" = "GEOID") %>%
`colnames<-`(str_replace(colnames(.),"E$",""))
crosswalk <- read.csv("G:\\Shared drives\\FY22 Regional Housing Initiative\\Data\\NHGIS\\nhgis_bg2010_tr2020.csv", colClasses = c("bg2010gj" = "character", "bg2010ge" = "character",	"tr2020gj" = "character",	"tr2020ge" = "character"))
raw_data_15_crosswalk <- merge(raw_data_15, crosswalk, by.x="GEOID_10", by.y="bg2010ge")
acs5_15_2020tracts <- raw_data_15_crosswalk %>%
mutate(POP_TOT_15 = round(POP_TOT * wt_pop, 0)) %>%
mutate(HH_TOT_15 = round(HH_TOT * wt_hh, 0)) %>%
mutate(UNITS_TOT_15 = round(UNITS_TOT * wt_hu, 0)) %>%
mutate(UNIT_1DET_15 = round(UNIT_1DET * wt_hu, 0)) %>%
mutate(UNIT_1ATT_15 = round(UNIT_1ATT * wt_hu, 0)) %>%
mutate(UNIT_2_15 = round(UNIT_2 * wt_hu, 0)) %>%
mutate(UNIT_3or4_15 = round(UNIT_3or4 * wt_hu, 0)) %>%
mutate(UNIT_5to9_15 = round(UNIT_5to9 * wt_hu, 0)) %>%
mutate(UNIT_1019_15 = round(UNIT_1019 * wt_hu, 0)) %>%
mutate(UNIT_2049_15 = round(UNIT_2049 * wt_hu, 0)) %>%
mutate(UNIT_50P_15 = round(UNIT_50P * wt_hu, 0)) %>%
select(tr2020ge, POP_TOT_15, HH_TOT_15, UNITS_TOT_15, UNIT_1DET_15, UNIT_1ATT_15, UNIT_2_15, UNIT_3or4_15, UNIT_5to9_15, UNIT_1019_15, UNIT_2049_15, UNIT_50P_15) %>%
group_by(tr2020ge) %>%
summarise(across(everything(), sum)) %>%
rename("GEOID" = "tr2020ge")
raw_data_20 <- get_acs(geography = "tract",
variables = acs5_15_vars_tot,
year = 2020,
state = dvrpc_states,
survey = "acs5",
output = "wide"
) %>%
mutate(year = 2020) %>%
filter(str_detect(GEOID, dvrpc_fips)) %>%
select(GEOID, year, ends_with("E"), -NAME)%>%
`colnames<-`(str_replace(colnames(.),"E$",""))
# Join datasets
check_df <- left_join(raw_data_20, acs5_15_2020tracts, by="GEOID")
tracts_submarkets <- read.csv("U:\\FY2022\\Planning\\RegionalHousingInitiative\\SubmarketAnalysis\\data\\LPA_Test3_Submarkets\\lpa_results_3_submarkets.csv", colClasses = c("X" = "character")) %>%
rename("GEOID" = "X") %>%
select(GEOID, Class)
tracts_submarkets <- read.csv("U:\\FY2022\\Planning\\RegionalHousingInitiative\\SubmarketAnalysis\\data\\v1\\tracts_class.csv", colClasses = c("GEOID" = "character")) %>%
select(GEOID, Class)
change_df <- left_join(tracts_submarkets, check_df, by="GEOID") %>%
select(Class, POP_TOT, POP_TOT_15, HH_TOT, HH_TOT_15, UNITS_TOT, UNITS_TOT_15, UNIT_1DET, UNIT_1DET_15, UNIT_1ATT, UNIT_1ATT_15, UNIT_2, UNIT_2_15, UNIT_3or4, UNIT_3or4_15, UNIT_5to9, UNIT_5to9_15, UNIT_1019, UNIT_1019_15, UNIT_2049, UNIT_2049_15, UNIT_50P, UNIT_50P_15) %>%
group_by(Class) %>%
summarise(across(everything(), sum)) %>%
mutate(POP_TOT_CHG = round(100 * ((POP_TOT - POP_TOT_15)/POP_TOT_15), 1)) %>%
mutate(HH_TOT_CHG = round(100 * ((HH_TOT - HH_TOT_15)/HH_TOT_15), 1)) %>%
mutate(UNIT_1DET_CHG = round(100 * ((UNIT_1DET - UNIT_1DET_15)/UNIT_1DET_15), 1)) %>%
mutate(UNIT_1ATT_CHG = round(100 * ((UNIT_1ATT - UNIT_1ATT_15)/UNIT_1ATT_15), 1)) %>%
mutate(UNIT_2_CHG = round(100 * ((UNIT_2 - UNIT_2_15)/UNIT_2_15), 1)) %>%
mutate(UNIT_3or4_CHG = round(100 * ((UNIT_3or4 - UNIT_3or4_15)/UNIT_3or4_15), 1)) %>%
mutate(UNIT_5to9_CHG = round(100 * ((UNIT_5to9 - UNIT_5to9_15)/UNIT_5to9_15), 1)) %>%
mutate(UNIT_1019_CHG = round(100 * ((UNIT_1019 - UNIT_1019_15)/UNIT_1019_15), 1)) %>%
mutate(UNIT_2049_CHG = round(100 * ((UNIT_2049 - UNIT_2049_15)/UNIT_2049_15), 1)) %>%
mutate(UNIT_50P_CHG = round(100 * ((UNIT_50P - UNIT_50P_15)/UNIT_50P_15), 1))
View(change_df)
write.csv(change_df, "U:\\FY2022\\Planning\\RegionalHousingInitiative\\SubmarketAnalysis\\data\\v1\\submarket_chg_2015_2020.csv")
file.edit("~/.Renviron")
print(api)
library(tidyverse)
library(dplyr)
library(rgdal)
library(tidycensus)
library(censusapi)
#Load Census API key
sys.getenv("CENSUS_API_KEY")
#Region FIPS
fips_region <- c("34005", "34007", "34015", "34021", "42017", "42029", "42045", "42091", "42101")
#Variable List - For Reference
acs5_varlist_2020 <- load_variables(year = 2020,
dataset = "acs5",
cache = TRUE)
# ---- Define Variables ----
acs5_20_overlay_vars <- c(
POP_TOT = "B01003_001",
# Aggregate Number of Vehicles Available
AGG_NUM_VEH = "B25046_001",
# Means of Transportation to Work
COMM_TOTHH = "B08101_001",
COMM_DRVAL = "B08101_009",
COMM_CARPL = "B08101_017",
COMM_PUBT = "B08101_025",
COMM_WALK = "B08101_033",
COMM_OTHR = "B08101_041",
COMM_WFHO = "B08101_049",
# Educational Attainment
EDU_TOTL = "B15003_001",
EDU_NONE = "B15003_002",
EDU_NURS = "B15003_003",
EDU_KIND = "B15003_004",
EDU_FRST = "B15003_005",
EDU_SCND = "B15003_006",
EDU_THRD = "B15003_007",
EDU_FRTH = "B15003_008",
EDU_FFTH = "B15003_009",
EDU_SXTH = "B15003_010",
EDU_SVTH = "B15003_011",
EDU_EGTH = "B15003_012",
EDU_NNTH = "B15003_013",
EDU_TNTH = "B15003_014",
EDU_ELTH = "B15003_015",
EDU_TWTH = "B15003_016",
EDU_HSCH = "B15003_017",
EDU_GEDE = "B15003_018",
EDU_SC1L = "B15003_019",
EDU_SCM1 = "B15003_020",
EDU_ASSO = "B15003_021",
EDU_BACH = "B15003_022",
EDU_MAST = "B15003_023",
EDU_PROF = "B15003_024",
EDU_DOCT = "B15003_025",
# Housing Cost Burden
## Gross Rent as a Percentage of Household Income (Renter-Occupied Housing Units)
RPI_TOTPOP = "B25070_001",
RPI_00to09 = "B25070_002",
RPI_10to14 = "B25070_003",
RPI_15to19 = "B25070_004",
RPI_20to24 = "B25070_005",
RPI_25to29 = "B25070_006",
RPI_30to34 = "B25070_007",
RPI_35to39 = "B25070_008",
RPI_40to49 = "B25070_009",
RPI_50more = "B25070_010",
RPI_NA = "B25070_011",
## Selected Monthly Owner Costs by Mortgage Status (Owner-Occupied Housing Units)
OPI_MORT_POP = "B25091_002",
OPI_00to09 = "B25091_003",
OPI_10to14 = "B25091_004",
OPI_15to19 = "B25091_005",
OPI_20to24 = "B25091_006",
OPI_25to29 = "B25091_007",
OPI_30to34 = "B25091_008",
OPI_35to39 = "B25091_009",
OPI_40to49 = "B25091_010",
OPI_50more = "B25091_011",
OPI_NA = "B25091_012",
# Total Population
POP_TOT = "B01003_001",
# Race and Ethnicity
POP_WHI = "B01001A_001",
POP_BLK = "B01001B_001",
POP_AIA = "B01001C_001",
POP_ASN = "B01001D_001",
POP_HPI = "B01001E_001",
POP_OTH = "B01001F_001",
POP_TWO = "B01001G_001",
POP_WNH = "B01001H_001",
POP_LAT = "B01001I_001",
# Unemployment
EMP_POPU = "B23025_001",
EMP_LABF = "B23025_002",
EMP_CVLF = "B23025_003",
EMP_UNEM = "B23025_005",
EMP_ARMF = "B23025_006"
)
dvrpc_states <- c(34, 42)
dvrpc_fips <- c('34005|34007|34015|34021|42017|42029|42045|42091|42101')
raw_data <- get_acs(geography = "tract",
variables = acs5_20_overlay_vars,
year = 2020,
state = dvrpc_states,
survey = "acs5",
output = "wide"
) %>%
mutate(year = 2020) %>%
filter(str_detect(GEOID, dvrpc_fips)) %>%
select(GEOID, year, ends_with("E"), -NAME)%>%
`colnames<-`(str_replace(colnames(.),"E$",""))
View(raw_data)
tracts_submarkets <- read.csv("G:\\Shared drives\\FY22 Regional Housing Initiative\\SubmarketAnalysis\\20230517_submarket_review\\v1\\data\\tracts_class.csv", colClasses = c("GEOID" = "character"))
View(tracts_submarkets)
overlay_submarkets <- left_join(tracts_submarkets, overlay_df, by = "GEOID")
overlay_df <- raw_data %>%
mutate(HC_BURD = round(100 * ((RPI_30to34 +
RPI_35to39 +
RPI_40to49 +
RPI_50more +
OPI_30to34 +
OPI_35to39 +
OPI_40to49 +
OPI_50more)
/(OPI_MORT_POP + RPI_TOTPOP)), 1)) %>%
mutate(HC_SEVB = round(100 * ((RPI_50more +
OPI_50more)
/(OPI_MORT_POP + RPI_TOTPOP)), 1)) %>%
select(GEOID,  HC_BURD, HC_SEVB)
overlay_submarkets <- left_join(tracts_submarkets, overlay_df, by = "GEOID")
View(overlay_submarkets)
overlay_df <- raw_data %>%
mutate(HC_BURD_NUM) = RPI_30to34 +
RPI_35to39 +
RPI_40to49 +
RPI_50more +
OPI_30to34 +
OPI_35to39 +
OPI_40to49 +
OPI_50more %>%
mutate(HC_BURD_DEN) = OPI_MORT_POP + RPI_TOTPOP %>%
mutate(HC_SEVB_NUM) = RPI_50more + OPI_50more %>%
mutate(HC_SEVB_DEN) = OPI_MORT_POP + RPI_TOTPOP %>%
select(Class, HC_BURD_NUM, HC_BURD_DEM, HC_SEVB_NUM, HC_SEVB_DEN)
# ---- Define Variables ----
acs5_20_overlay_vars <- c(
POP_TOT = "B01003_001",
# Aggregate Number of Vehicles Available
AGG_NUM_VEH = "B25046_001",
# Means of Transportation to Work
COMM_TOTHH = "B08101_001",
COMM_DRVAL = "B08101_009",
COMM_CARPL = "B08101_017",
COMM_PUBT = "B08101_025",
COMM_WALK = "B08101_033",
COMM_OTHR = "B08101_041",
COMM_WFHO = "B08101_049",
# Educational Attainment
EDU_TOTL = "B15003_001",
EDU_NONE = "B15003_002",
EDU_NURS = "B15003_003",
EDU_KIND = "B15003_004",
EDU_FRST = "B15003_005",
EDU_SCND = "B15003_006",
EDU_THRD = "B15003_007",
EDU_FRTH = "B15003_008",
EDU_FFTH = "B15003_009",
EDU_SXTH = "B15003_010",
EDU_SVTH = "B15003_011",
EDU_EGTH = "B15003_012",
EDU_NNTH = "B15003_013",
EDU_TNTH = "B15003_014",
EDU_ELTH = "B15003_015",
EDU_TWTH = "B15003_016",
EDU_HSCH = "B15003_017",
EDU_GEDE = "B15003_018",
EDU_SC1L = "B15003_019",
EDU_SCM1 = "B15003_020",
EDU_ASSO = "B15003_021",
EDU_BACH = "B15003_022",
EDU_MAST = "B15003_023",
EDU_PROF = "B15003_024",
EDU_DOCT = "B15003_025",
# Housing Cost Burden
## Gross Rent as a Percentage of Household Income (Renter-Occupied Housing Units)
RPI_TOTPOP = "B25070_001",
RPI_00to09 = "B25070_002",
RPI_10to14 = "B25070_003",
RPI_15to19 = "B25070_004",
RPI_20to24 = "B25070_005",
RPI_25to29 = "B25070_006",
RPI_30to34 = "B25070_007",
RPI_35to39 = "B25070_008",
RPI_40to49 = "B25070_009",
RPI_50more = "B25070_010",
RPI_NA = "B25070_011",
## Selected Monthly Owner Costs by Mortgage Status (Owner-Occupied Housing Units)
OPI_MORT_POP = "B25091_002",
OPI_00to09 = "B25091_003",
OPI_10to14 = "B25091_004",
OPI_15to19 = "B25091_005",
OPI_20to24 = "B25091_006",
OPI_25to29 = "B25091_007",
OPI_30to34 = "B25091_008",
OPI_35to39 = "B25091_009",
OPI_40to49 = "B25091_010",
OPI_50more = "B25091_011",
OPI_NA = "B25091_012",
# Total Population
POP_TOT = "B01003_001",
# Race and Ethnicity
POP_WHI = "B01001A_001",
POP_BLK = "B01001B_001",
POP_AIA = "B01001C_001",
POP_ASN = "B01001D_001",
POP_HPI = "B01001E_001",
POP_OTH = "B01001F_001",
POP_TWO = "B01001G_001",
POP_WNH = "B01001H_001",
POP_LAT = "B01001I_001",
# Unemployment
EMP_POPU = "B23025_001",
EMP_LABF = "B23025_002",
EMP_CVLF = "B23025_003",
EMP_UNEM = "B23025_005",
EMP_ARMF = "B23025_006"
)
dvrpc_states <- c(34, 42)
dvrpc_fips <- c('34005|34007|34015|34021|42017|42029|42045|42091|42101')
raw_data <- get_acs(geography = "tract",
variables = acs5_20_overlay_vars,
year = 2020,
state = dvrpc_states,
survey = "acs5",
output = "wide"
) %>%
mutate(year = 2020) %>%
filter(str_detect(GEOID, dvrpc_fips)) %>%
select(GEOID, year, ends_with("E"), -NAME)%>%
`colnames<-`(str_replace(colnames(.),"E$",""))
# Import Submarket Results
tracts_submarkets <- read.csv("G:\\Shared drives\\FY22 Regional Housing Initiative\\SubmarketAnalysis\\20230517_submarket_review\\v1\\data\\tracts_class.csv", colClasses = c("GEOID" = "character"))
burden_df <- raw_data %>%
mutate(HC_BURD_NUM) = RPI_30to34 +
RPI_35to39 +
RPI_40to49 +
RPI_50more +
OPI_30to34 +
OPI_35to39 +
OPI_40to49 +
OPI_50more %>%
mutate(HC_BURD_DEN) = OPI_MORT_POP + RPI_TOTPOP %>%
mutate(HC_SEVB_NUM) = RPI_50more + OPI_50more %>%
mutate(HC_SEVB_DEN) = OPI_MORT_POP + RPI_TOTPOP %>%
select(GEOID, Class, HC_BURD_NUM, HC_BURD_DEM, HC_SEVB_NUM, HC_SEVB_DEN)
View(raw_data)
# Author: Brian Carney
# Last updated: 09/13/2023
# Prepared for: Region Housing Initiative - Submarket Clustering Analysis Overlays
# Set working directory
setwd("C:\\Users\\bcarney\\Documents\\GitHub\\housing_initiative_submarkets\\R")
# Load packages
library(tidyverse)
library(dplyr)
library(rgdal)
library(tidycensus)
library(censusapi)
#Load Census API key
sys.getenv("CENSUS_API_KEY")
#Region FIPS
fips_region <- c("34005", "34007", "34015", "34021", "42017", "42029", "42045", "42091", "42101")
#Variable List - For Reference
acs5_varlist_2020 <- load_variables(year = 2020,
dataset = "acs5",
cache = TRUE)
# ---- Define Variables ----
acs5_20_overlay_vars <- c(
POP_TOT = "B01003_001",
# Aggregate Number of Vehicles Available
AGG_NUM_VEH = "B25046_001",
# Means of Transportation to Work
COMM_TOTHH = "B08101_001",
COMM_DRVAL = "B08101_009",
COMM_CARPL = "B08101_017",
COMM_PUBT = "B08101_025",
COMM_WALK = "B08101_033",
COMM_OTHR = "B08101_041",
COMM_WFHO = "B08101_049",
# Educational Attainment
EDU_TOTL = "B15003_001",
EDU_NONE = "B15003_002",
EDU_NURS = "B15003_003",
EDU_KIND = "B15003_004",
EDU_FRST = "B15003_005",
EDU_SCND = "B15003_006",
EDU_THRD = "B15003_007",
EDU_FRTH = "B15003_008",
EDU_FFTH = "B15003_009",
EDU_SXTH = "B15003_010",
EDU_SVTH = "B15003_011",
EDU_EGTH = "B15003_012",
EDU_NNTH = "B15003_013",
EDU_TNTH = "B15003_014",
EDU_ELTH = "B15003_015",
EDU_TWTH = "B15003_016",
EDU_HSCH = "B15003_017",
EDU_GEDE = "B15003_018",
EDU_SC1L = "B15003_019",
EDU_SCM1 = "B15003_020",
EDU_ASSO = "B15003_021",
EDU_BACH = "B15003_022",
EDU_MAST = "B15003_023",
EDU_PROF = "B15003_024",
EDU_DOCT = "B15003_025",
# Housing Cost Burden
## Gross Rent as a Percentage of Household Income (Renter-Occupied Housing Units)
RPI_TOTPOP = "B25070_001",
RPI_00to09 = "B25070_002",
RPI_10to14 = "B25070_003",
RPI_15to19 = "B25070_004",
RPI_20to24 = "B25070_005",
RPI_25to29 = "B25070_006",
RPI_30to34 = "B25070_007",
RPI_35to39 = "B25070_008",
RPI_40to49 = "B25070_009",
RPI_50more = "B25070_010",
RPI_NA = "B25070_011",
## Selected Monthly Owner Costs by Mortgage Status (Owner-Occupied Housing Units)
OPI_MORT_POP = "B25091_002",
OPI_00to09 = "B25091_003",
OPI_10to14 = "B25091_004",
OPI_15to19 = "B25091_005",
OPI_20to24 = "B25091_006",
OPI_25to29 = "B25091_007",
OPI_30to34 = "B25091_008",
OPI_35to39 = "B25091_009",
OPI_40to49 = "B25091_010",
OPI_50more = "B25091_011",
OPI_NA = "B25091_012",
# Total Population
POP_TOT = "B01003_001",
# Race and Ethnicity
POP_WHI = "B01001A_001",
POP_BLK = "B01001B_001",
POP_AIA = "B01001C_001",
POP_ASN = "B01001D_001",
POP_HPI = "B01001E_001",
POP_OTH = "B01001F_001",
POP_TWO = "B01001G_001",
POP_WNH = "B01001H_001",
POP_LAT = "B01001I_001",
# Unemployment
EMP_POPU = "B23025_001",
EMP_LABF = "B23025_002",
EMP_CVLF = "B23025_003",
EMP_UNEM = "B23025_005",
EMP_ARMF = "B23025_006"
)
dvrpc_states <- c(34, 42)
dvrpc_fips <- c('34005|34007|34015|34021|42017|42029|42045|42091|42101')
raw_data <- get_acs(geography = "tract",
variables = acs5_20_overlay_vars,
year = 2020,
state = dvrpc_states,
survey = "acs5",
output = "wide"
) %>%
mutate(year = 2020) %>%
filter(str_detect(GEOID, dvrpc_fips)) %>%
select(GEOID, year, ends_with("E"), -NAME)%>%
`colnames<-`(str_replace(colnames(.),"E$",""))
tracts_submarkets <- read.csv("G:\\Shared drives\\FY22 Regional Housing Initiative\\SubmarketAnalysis\\20230517_submarket_review\\v1\\data\\tracts_class.csv", colClasses = c("GEOID" = "character"))
# Overlay Variables
burden_df <- raw_data %>%
mutate(HC_BURD_NUM = RPI_30to34 +
RPI_35to39 +
RPI_40to49 +
RPI_50more +
OPI_30to34 +
OPI_35to39 +
OPI_40to49 +
OPI_50more) %>%
mutate(HC_BURD_DEN = OPI_MORT_POP + RPI_TOTPOP) %>%
mutate(HC_SEVB_NUM = RPI_50more + OPI_50more) %>%
mutate(HC_SEVB_DEN = OPI_MORT_POP + RPI_TOTPOP) %>%
select(GEOID, Class, HC_BURD_NUM, HC_BURD_DEN, HC_SEVB_NUM, HC_SEVB_DEN)
# Overlay Variables
burden_df <- raw_data %>%
mutate(HC_BURD_NUM = RPI_30to34 +
RPI_35to39 +
RPI_40to49 +
RPI_50more +
OPI_30to34 +
OPI_35to39 +
OPI_40to49 +
OPI_50more) %>%
mutate(HC_BURD_DEN = OPI_MORT_POP + RPI_TOTPOP) %>%
mutate(HC_SEVB_NUM = RPI_50more + OPI_50more) %>%
mutate(HC_SEVB_DEN = OPI_MORT_POP + RPI_TOTPOP) %>%
select(GEOID, HC_BURD_NUM, HC_BURD_DEN, HC_SEVB_NUM, HC_SEVB_DEN)
overlay_submarkets <- left_join(tracts_submarkets, burden, by = "GEOID")
overlay_submarkets <- left_join(tracts_submarkets, burden_df, by = "GEOID")
View(overlay_submarkets)
# Join Overlay DF with Submarket Results
overlay_submarkets <- left_join(tracts_submarkets, burden_df, by = "GEOID") %>%
select(Class, HC_BURD_NUM, HC_BURD_DEN, HC_SEVB_NUM, HC_SEVB_DEN)
View(overlay_submarkets)
overlay_submarkets <- left_join(tracts_submarkets, burden_df, by = "GEOID") %>%
select(Class, HC_BURD_NUM, HC_BURD_DEN, HC_SEVB_NUM, HC_SEVB_DEN) %>%
group_by(Class) %>%
summarise()
View(overlay_submarkets)
overlay_submarkets <- left_join(tracts_submarkets, burden_df, by = "GEOID") %>%
select(Class, HC_BURD_NUM, HC_BURD_DEN, HC_SEVB_NUM, HC_SEVB_DEN) %>%
group_by(Class) %>%
summarise(sum())
View(overlay_submarkets)
overlay_submarkets <- left_join(tracts_submarkets, burden_df, by = "GEOID") %>%
select(Class, HC_BURD_NUM, HC_BURD_DEN, HC_SEVB_NUM, HC_SEVB_DEN) %>%
group_by(Class) %>%
summarise(across(everything(), sum),
.groups = 'drop')
View(overlay_submarkets)
# Join Overlay DF with Submarket Results
overlay_submarkets <- left_join(tracts_submarkets, burden_df, by = "GEOID") %>%
select(Class, HC_BURD_NUM, HC_BURD_DEN, HC_SEVB_NUM, HC_SEVB_DEN) %>%
group_by(Class) %>%
summarise(across(everything(), sum),
.groups = 'drop') %>%
mutate(submarket_cost_burd = round(100 * (HC_BURD_NUM/HC_BURD_DEN), 1)) %>%
mutate(submarket_sev_cost_burd = round(100 * (HC_SEVB_NUM/HC_SEVB_DEN), 1))
View(overlay_submarkets)
write.csv(cost_burden_submarkets, "G:\\Shared drives\\FY22 Regional Housing Initiative\\SubmarketAnalysis\\20230517_submarket_review\\v1\\data\\submarkets_cost_burden.csv")
# Join Overlay DF with Submarket Results
cost_burden_submarkets <- left_join(tracts_submarkets, burden_df, by = "GEOID") %>%
select(Class, HC_BURD_NUM, HC_BURD_DEN, HC_SEVB_NUM, HC_SEVB_DEN) %>%
group_by(Class) %>%
summarise(across(everything(), sum),
.groups = 'drop') %>%
mutate(submarket_cost_burd = round(100 * (HC_BURD_NUM/HC_BURD_DEN), 1)) %>%
mutate(submarket_sev_cost_burd = round(100 * (HC_SEVB_NUM/HC_SEVB_DEN), 1))
write.csv(cost_burden_submarkets, "G:\\Shared drives\\FY22 Regional Housing Initiative\\SubmarketAnalysis\\20230517_submarket_review\\v1\\data\\submarkets_cost_burden.csv")
cost_burden_submarkets <- left_join(tracts_submarkets, burden_df, by = "GEOID") %>%
select(Class, HC_BURD_NUM, HC_BURD_DEN, HC_SEVB_NUM, HC_SEVB_DEN) %>%
group_by(Class) %>%
summarise(across(everything(), sum),
.groups = 'drop') %>%
mutate(submarket_cost_burd = round(HC_BURD_NUM/HC_BURD_DEN, 3)) %>%
mutate(submarket_sev_cost_burd = round(HC_SEVB_NUM/HC_SEVB_DEN, 3))
View(cost_burden_submarkets)
write.csv(cost_burden_submarkets, "G:\\Shared drives\\FY22 Regional Housing Initiative\\SubmarketAnalysis\\20230517_submarket_review\\v1\\data\\submarkets_cost_burden.csv")
